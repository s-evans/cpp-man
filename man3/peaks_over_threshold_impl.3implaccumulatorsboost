.\"Generated by db2man.xsl. Don't modify this, modify the source.
.de Sh \" Subsection
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Ip \" List item
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.TH "STRUCT T" 3 "" "" ""
.SH "NAME"
boost::accumulators::impl::peaks_over_threshold_impl \- Peaks over Threshold Method for Quantile and Tail Mean Estimation\&.
.SH "SYNOPSIS"

.sp
.nf
// In header: <boost/accumulators/statistics/peaks_over_threshold\&.hpp>

template<typename Sample, typename LeftRight> 
struct peaks_over_threshold_impl : public accumulator_base {
  // types
  typedef numeric::functional::fdiv< Sample, std::size_t >::result_type float_type; 
  typedef boost::tuple< float_type, float_type, float_type >            result_type;
  typedef mpl::int_< is_same< LeftRight, left >::value?\-1:1 >           sign;       

  // construct/copy/destruct
  template<typename Args> peaks_over_threshold_impl(Args const &);

  // public member functions
  template<typename Args> void operator()(Args const &);
  template<typename Args> result_type result(Args const &) const;
};
.fi
.SH "DESCRIPTION"
.PP
According to the theorem of Pickands\-Balkema\-de Haan, the distribution function
\&\s-2\u[1]\d\s+2[IMAGE]\&\s-2\u[2]\d\s+2 [$F_u(x)$]
of the excesses
\&\s-2\u[3]\d\s+2[IMAGE]\&\s-2\u[4]\d\s+2 [$x$]
over some sufficiently high threshold
\&\s-2\u[5]\d\s+2[IMAGE]\&\s-2\u[6]\d\s+2 [$u$]
of a distribution function
\&\s-2\u[7]\d\s+2[IMAGE]\&\s-2\u[8]\d\s+2 [$F(x)$]
may be approximated by a generalized Pareto distribution
\fBEquation 1.1. \fR \&\s-2\u[9]\d\s+2.sp .RS 4 [IMAGE]\&\s-2\u[10]\d\s+2 \e[ G_{\exi,\ebeta}(x) = \eleft\e{ \ebegin{array}{ll} \ebeta^{\-1}\eleft(1+\efrac{\exi x}{\ebeta}\eright)^{\-1/\exi\-1} & \etextrm{if }\exi\eneq0\e\e \ebeta^{\-1}\eexp\eleft(\-\efrac{x}{\ebeta}\eright) & \etextrm{if }\exi=0, \eend{array} \eright\&. \e] .RE
with suitable parameters
\&\s-2\u[11]\d\s+2[IMAGE]\&\s-2\u[12]\d\s+2 [$\xi$]
and
\&\s-2\u[13]\d\s+2[IMAGE]\&\s-2\u[14]\d\s+2 [$\beta$]
that can be estimated, e\&.g\&., with the method of moments, cf\&. Hosking and Wallis (1987),
\fBEquation 1.2. \fR \&\s-2\u[15]\d\s+2.sp .RS 4 [IMAGE]\&\s-2\u[16]\d\s+2 \e[ \ebegin{array}{lll} \ehat{\exi} & = & \efrac{1}{2}\eleft[1\-\efrac{(\ehat{\emu}\-u)^2}{\ehat{\esigma}^2}\eright]\e\e \ehat{\ebeta} & = & \efrac{\ehat{\emu}\-u}{2}\eleft[\efrac{(\ehat{\emu}\-u)^2}{\ehat{\esigma}^2}+1\eright], \eend{array} \e] .RE
\&\s-2\u[17]\d\s+2[IMAGE]\&\s-2\u[18]\d\s+2 [$\hat{\mu}$]
and
\&\s-2\u[19]\d\s+2[IMAGE]\&\s-2\u[20]\d\s+2 [$\hat{\sigma}^2$]
being the empirical mean and variance of the samples over the threshold
\&\s-2\u[21]\d\s+2[IMAGE]\&\s-2\u[6]\d\s+2 [$u$]\&. Equivalently, the distribution function
\&\s-2\u[22]\d\s+2[IMAGE]\&\s-2\u[23]\d\s+2 [$F_u(x-u)$]
of the exceedances
\&\s-2\u[24]\d\s+2[IMAGE]\&\s-2\u[25]\d\s+2 [$x-u$]
can be approximated by
\&\s-2\u[26]\d\s+2[IMAGE]\&\s-2\u[27]\d\s+2 [$G_{\xi,\beta}(x-u)=G_{\xi,\beta,u}(x)$]\&. Since for
\&\s-2\u[28]\d\s+2[IMAGE]\&\s-2\u[29]\d\s+2 [$x\geq u$]
the distribution function
\&\s-2\u[30]\d\s+2[IMAGE]\&\s-2\u[8]\d\s+2 [$F(x)$]
can be written as
\fBEquation 1.3. \fR \&\s-2\u[31]\d\s+2.sp .RS 4 [IMAGE]\&\s-2\u[32]\d\s+2 \e[ F(x) = [1 \- \eP(X \eleq u)]F_u(x \- u) + \eP(X \eleq u) \e] .RE
and the probability
\&\s-2\u[33]\d\s+2[IMAGE]\&\s-2\u[34]\d\s+2 [$\P(X \leq u)$]
can be approximated by the empirical distribution function
\&\s-2\u[35]\d\s+2[IMAGE]\&\s-2\u[36]\d\s+2 [$F_n(u)$]
evaluated at
\&\s-2\u[37]\d\s+2[IMAGE]\&\s-2\u[6]\d\s+2 [$u$], an estimator of
\&\s-2\u[38]\d\s+2[IMAGE]\&\s-2\u[8]\d\s+2 [$F(x)$]
is given by
\fBEquation 1.4. \fR \&\s-2\u[39]\d\s+2.sp .RS 4 [IMAGE]\&\s-2\u[40]\d\s+2 \e[ \ewidehat{F}(x) = [1 \- F_n(u)]G_{\exi,\ebeta,u}(x) + F_n(u)\&. \e] .RE
It can be shown that
\&\s-2\u[41]\d\s+2[IMAGE]\&\s-2\u[42]\d\s+2 [$\widehat{F}(x)$]
is a generalized Pareto distribution
\&\s-2\u[43]\d\s+2[IMAGE]\&\s-2\u[44]\d\s+2 [$G_{\xi,\bar{\beta},\bar{u}}(x)$]
with
\&\s-2\u[45]\d\s+2[IMAGE]\&\s-2\u[46]\d\s+2 [$\bar{\beta}=\beta[1-F_n(u)]^{\xi}$]
and
\&\s-2\u[47]\d\s+2[IMAGE]\&\s-2\u[48]\d\s+2 [$\bar{u}=u-\bar{\beta}\left\{[1-F_n(u)]^{-\xi}-1\right\}/\xi$]\&. By inverting
\&\s-2\u[49]\d\s+2[IMAGE]\&\s-2\u[42]\d\s+2 [$\widehat{F}(x)$], one obtains an estimator for the
\&\s-2\u[50]\d\s+2[IMAGE]\&\s-2\u[51]\d\s+2 [$\alpha$]\-quantile,
\fBEquation 1.5. \fR \&\s-2\u[52]\d\s+2.sp .RS 4 [IMAGE]\&\s-2\u[53]\d\s+2 \e[ \ehat{q}_{\ealpha} = \ebar{u} + \efrac{\ebar{\ebeta}}{\exi}\eleft[(1\-\ealpha)^{\-\exi}\-1\eright], \e] .RE
and similarly an estimator for the (coherent) tail mean,
\fBEquation 1.6. \fR \&\s-2\u[54]\d\s+2.sp .RS 4 [IMAGE]\&\s-2\u[55]\d\s+2 \e[ \ewidehat{CTM}_{\ealpha} = \ehat{q}_{\ealpha} \- \efrac{\ebar{\ebeta}}{\exi\-1}(1\-\ealpha)^{\-\exi}, \e] .RE
cf\&. McNeil and Frey (2000)\&.
.PP
Note that in case extreme values of the left tail are fitted, the distribution is mirrored with respect to the
\&\s-2\u[56]\d\s+2[IMAGE]\&\s-2\u[57]\d\s+2 [$y$]
axis such that the left tail can be treated as a right tail\&. The computed fit parameters thus define the Pareto distribution that fits the mirrored left tail\&. When quantities like a quantile or a tail mean are computed using the fit parameters obtained from the mirrored data, the result is mirrored back, yielding the correct result\&.
.PP
For further details, see
.PP
J\&. R\&. M\&. Hosking and J\&. R\&. Wallis, Parameter and quantile estimation for the generalized Pareto distribution, Technometrics, Volume 29, 1987, p\&. 339\-349
.PP
A\&. J\&. McNeil and R\&. Frey, Estimation of Tail\-Related Risk Measures for Heteroscedastic Financial Time Series: an Extreme Value Approach, Journal of Empirical Finance, Volume 7, 2000, p\&. 271\-300
.PP

.SS "peaks_over_threshold_impl public construct/copy/destruct"

.sp
.RS 4
.ie n \{\
\h'-04' 1.\h'+01'\c
.\}
.el \{\
.sp -1
.IP "  1." 4.2
.\}

.sp

.nf
template<typename Args> peaks_over_threshold_impl(Args const & args);
.fi

.RE

.SS "peaks_over_threshold_impl public member functions"

.sp
.RS 4
.ie n \{\
\h'-04' 1.\h'+01'\c
.\}
.el \{\
.sp -1
.IP "  1." 4.2
.\}

.sp

.nf
template<typename Args> void operator()(Args const & args);
.fi

.RE


.sp
.RS 4
.ie n \{\
\h'-04' 2.\h'+01'\c
.\}
.el \{\
.sp -1
.IP "  2." 4.2
.\}

.sp

.nf
template<typename Args> result_type result(Args const & args) const;
.fi

.RE


